#!/usr/bin/env ruby

require "securerandom"

dir = File.expand_path("../../", __FILE__)
ENV["BUNDLE_GEMFILE"] ||= File.join(dir, "Gemfile.production")
ENV["SECRET_KEY_BASE"] ||= SecureRandom.hex(64)
ENV["RAILS_ENV"] ||= "production"
system(*%W(bundle exec rake db:create db:migrate db:seed))
system(*%W(bundle exec rackup -E production #{dir}/config.ru))
